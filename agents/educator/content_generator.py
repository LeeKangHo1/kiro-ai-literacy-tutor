# agents/educator/content_generator.py
# ê¸°ë³¸ ì½˜í…ì¸  ìƒì„± ë¡œì§ êµ¬í˜„

from typing import Dict, List, Any, Optional
from workflow.state_management import TutorState, StateManager


class ContentGenerator:
    """ì´ë¡  ì½˜í…ì¸  ìƒì„±ì„ ë‹´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤"""
    
    def __init__(self):
        # ì±•í„°ë³„ ê¸°ë³¸ ì½˜í…ì¸  í…œí”Œë¦¿
        self.chapter_templates = {
            1: {
                'title': 'AIëŠ” ë¬´ì—‡ì¸ê°€?',
                'objectives': [
                    'AI, ML, DLì˜ ê°œë…ê³¼ ì°¨ì´ì  ì´í•´',
                    'AIì˜ ì‹¤ìƒí™œ ì ìš© ì‚¬ë¡€ íŒŒì•…',
                    'AI ê¸°ìˆ ì˜ í•œê³„ì™€ ê°€ëŠ¥ì„± ì¸ì‹'
                ],
                'key_concepts': ['AI', 'Machine Learning', 'Deep Learning', 'ì•Œê³ ë¦¬ì¦˜', 'ë°ì´í„°'],
                'examples': {
                    'beginner': [
                        'ìŠ¤ë§ˆíŠ¸í°ì˜ ìŒì„±ì¸ì‹ (Siri, êµ¬ê¸€ ì–´ì‹œìŠ¤í„´íŠ¸)',
                        'ë„·í”Œë¦­ìŠ¤ì˜ ì˜í™” ì¶”ì²œ ì‹œìŠ¤í…œ',
                        'ìë™ì°¨ì˜ ë‚´ë¹„ê²Œì´ì…˜ ì‹œìŠ¤í…œ'
                    ],
                    'business': [
                        'ê³ ê° í–‰ë™ ì˜ˆì¸¡ ë¶„ì„',
                        'ìë™í™”ëœ ê³ ê° ì„œë¹„ìŠ¤ ì±—ë´‡',
                        'ê³µê¸‰ë§ ìµœì í™” ì‹œìŠ¤í…œ'
                    ]
                }
            },
            2: {
                'title': 'LLMì´ë€ ë¬´ì—‡ì¸ê°€?',
                'objectives': [
                    'LLM(Large Language Model)ì˜ ì •ì˜ì™€ íŠ¹ì§• ì´í•´',
                    'GPT, BERT, Transformer êµ¬ì¡°ì˜ ê¸°ë³¸ ê°œë… íŒŒì•…',
                    'LLMì˜ ë°œì „ ê³¼ì •ê³¼ ì£¼ìš” ëª¨ë¸ë“¤ì˜ ì°¨ì´ì  ì¸ì‹'
                ],
                'key_concepts': ['LLM', 'GPT', 'BERT', 'Transformer', 'í† í°', 'íŒŒë¼ë¯¸í„°', 'ì‚¬ì „í›ˆë ¨'],
                'examples': {
                    'beginner': [
                        'ChatGPT - ëŒ€í™”í˜• AI ì–´ì‹œìŠ¤í„´íŠ¸',
                        'Google Bard - êµ¬ê¸€ì˜ ëŒ€í™”í˜• AI',
                        'Claude - Anthropicì˜ AI ì–´ì‹œìŠ¤í„´íŠ¸'
                    ],
                    'business': [
                        'ë¬¸ì„œ ìë™ ìƒì„± ë° í¸ì§‘ ë„êµ¬',
                        'ê³ ê° ì„œë¹„ìŠ¤ ìë™í™” ì‹œìŠ¤í…œ',
                        'ì½”ë“œ ìƒì„± ë° ë¦¬ë·° ë„êµ¬ (GitHub Copilot)'
                    ]
                }
            },
            3: {
                'title': 'í”„ë¡¬í”„íŠ¸ë€ ë¬´ì—‡ì¸ê°€?',
                'objectives': [
                    'í”„ë¡¬í”„íŠ¸ì˜ ì •ì˜ì™€ ì¤‘ìš”ì„± ì´í•´',
                    'íš¨ê³¼ì ì¸ í”„ë¡¬í”„íŠ¸ ì‘ì„± ì›ì¹™ í•™ìŠµ',
                    'ì‹¤ì œ í”„ë¡¬í”„íŠ¸ ì‘ì„± ë° í…ŒìŠ¤íŠ¸ ê²½í—˜'
                ],
                'key_concepts': ['í”„ë¡¬í”„íŠ¸', 'LLM', 'ChatGPT', 'ëª…ë ¹ì–´', 'ì»¨í…ìŠ¤íŠ¸'],
                'examples': {
                    'beginner': [
                        'ê°„ë‹¨í•œ ì§ˆë¬¸í•˜ê¸°: "ì˜¤ëŠ˜ ë‚ ì”¨ ì–´ë•Œ?"',
                        'ë²ˆì—­ ìš”ì²­: "Helloë¥¼ í•œêµ­ì–´ë¡œ ë²ˆì—­í•´ì¤˜"',
                        'ìš”ì•½ ìš”ì²­: "ì´ ê¸€ì„ 3ì¤„ë¡œ ìš”ì•½í•´ì¤˜"'
                    ],
                    'business': [
                        'ë³´ê³ ì„œ ì‘ì„±: "ë¶„ê¸°ë³„ ë§¤ì¶œ ë³´ê³ ì„œ ì´ˆì•ˆ ì‘ì„±"',
                        'ì´ë©”ì¼ ì‘ì„±: "ê³ ê° ë¶ˆë§Œ ì²˜ë¦¬ ì´ë©”ì¼ ì‘ì„±"',
                        'ì•„ì´ë””ì–´ ìƒì„±: "ì‹ ì œí’ˆ ë§ˆì¼€íŒ… ì „ëµ ì•„ì´ë””ì–´ 10ê°œ"'
                    ]
                }
            },
            4: {
                'title': 'ChatGPTë¡œ í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤',
                'objectives': [
                    'ChatGPTì˜ ì£¼ìš” í™œìš© ë¶„ì•¼ì™€ ê¸°ëŠ¥ ì´í•´',
                    'ìš”ì•½, ë²ˆì—­, ì§ˆë¬¸ ìƒì„± ë“± ì‹¤ìš©ì  ê¸°ëŠ¥ ì²´í—˜',
                    'ì—…ë¬´ íš¨ìœ¨ì„± í–¥ìƒì„ ìœ„í•œ ChatGPT í™œìš©ë²• í•™ìŠµ'
                ],
                'key_concepts': ['í…ìŠ¤íŠ¸ ìƒì„±', 'ìš”ì•½', 'ë²ˆì—­', 'ì§ˆë¬¸ ìƒì„±', 'ì½”ë“œ ì‘ì„±', 'ì°½ì‘', 'ë¶„ì„'],
                'examples': {
                    'beginner': [
                        'ê¸´ ê¸€ ìš”ì•½í•˜ê¸°: "ì´ ê¸°ì‚¬ë¥¼ 3ì¤„ë¡œ ìš”ì•½í•´ì¤˜"',
                        'ì–¸ì–´ ë²ˆì—­í•˜ê¸°: "ì´ ë¬¸ì¥ì„ ì˜ì–´ë¡œ ë²ˆì—­í•´ì¤˜"',
                        'ì•„ì´ë””ì–´ ìƒì„±í•˜ê¸°: "ì—¬í–‰ ê³„íš ì•„ì´ë””ì–´ 10ê°œ ì•Œë ¤ì¤˜"'
                    ],
                    'business': [
                        'íšŒì˜ë¡ ìš”ì•½ ë° ì•¡ì…˜ ì•„ì´í…œ ì¶”ì¶œ',
                        'ë§ˆì¼€íŒ… ì¹´í”¼ ë° ì œì•ˆì„œ ì´ˆì•ˆ ì‘ì„±',
                        'ë°ì´í„° ë¶„ì„ ê²°ê³¼ í•´ì„ ë° ë³´ê³ ì„œ ìƒì„±'
                    ]
                }
            },
            5: {
                'title': 'AI ì‹œëŒ€ì˜ ë¬¸í•´ë ¥',
                'objectives': [
                    'AI ê¸°ìˆ ì˜ ìœ¤ë¦¬ì  ê³ ë ¤ì‚¬í•­ ì´í•´',
                    'AIì˜ í˜„ì¬ í•œê³„ì™€ ë¯¸ë˜ ë°œì „ ë°©í–¥ íŒŒì•…',
                    'AI ì‹œëŒ€ì— í•„ìš”í•œ ìƒˆë¡œìš´ ì—­ëŸ‰ê³¼ ì§„ë¡œ íƒìƒ‰'
                ],
                'key_concepts': ['AI ìœ¤ë¦¬', 'í¸í–¥ì„±', 'ê°œì¸ì •ë³´ë³´í˜¸', 'ì¼ìë¦¬ ë³€í™”', 'ë””ì§€í„¸ ë¦¬í„°ëŸ¬ì‹œ', 'ì°½ì˜ì„±'],
                'examples': {
                    'beginner': [
                        'AIê°€ ë§Œë“  ê°€ì§œ ë‰´ìŠ¤ êµ¬ë³„í•˜ê¸°',
                        'AI ë„êµ¬ë¥¼ í™œìš©í•œ í•™ìŠµ ë°©ë²•',
                        'AIì™€ í•¨ê»˜ ì¼í•˜ëŠ” ìƒˆë¡œìš´ ì§ì—…ë“¤'
                    ],
                    'business': [
                        'AI ë„ì… ì‹œ ìœ¤ë¦¬ì  ê°€ì´ë“œë¼ì¸ ìˆ˜ë¦½',
                        'AI ê¸°ë°˜ ì˜ì‚¬ê²°ì •ì˜ íˆ¬ëª…ì„± í™•ë³´',
                        'AI ì‹œëŒ€ì˜ ì¸ì¬ ìœ¡ì„± ì „ëµ'
                    ]
                }
            }
        }
        
        # ë‚œì´ë„ë³„ ì„¤ëª… ìŠ¤íƒ€ì¼
        self.explanation_styles = {
            'low': {
                'tone': 'ì¹œê·¼í•˜ê³  ì‰¬ìš´',
                'vocabulary': 'ì¼ìƒ ìš©ì–´ ì¤‘ì‹¬',
                'examples': 'ìƒí™œ ë°€ì°©í˜•',
                'length': 'ê°„ê²°í•˜ê³  í•µì‹¬ì '
            },
            'medium': {
                'tone': 'ì²´ê³„ì ì´ê³  ëª…í™•í•œ',
                'vocabulary': 'ê¸°ìˆ  ìš©ì–´ + ì„¤ëª…',
                'examples': 'ì‹¤ë¬´ ì¤‘ì‹¬',
                'length': 'ì ë‹¹í•œ ìƒì„¸ë„'
            },
            'high': {
                'tone': 'ì „ë¬¸ì ì´ê³  ì‹¬í™”ëœ',
                'vocabulary': 'ê¸°ìˆ  ìš©ì–´ í™œìš©',
                'examples': 'ê³ ê¸‰ ì‚¬ë¡€',
                'length': 'ìƒì„¸í•˜ê³  í¬ê´„ì '
            }
        }
    
    def generate_theory_content(self, chapter: int, user_type: str, 
                               user_level: str, context: str = "") -> Dict[str, Any]:
        """ì´ë¡  ì½˜í…ì¸  ìƒì„±"""
        
        if chapter not in self.chapter_templates:
            return self._generate_fallback_content(chapter, user_type, user_level)
        
        template = self.chapter_templates[chapter]
        style = self.explanation_styles.get(user_level, self.explanation_styles['medium'])
        
        content = {
            'chapter': chapter,
            'title': template['title'],
            'introduction': self._generate_introduction(template, user_type, user_level),
            'main_content': self._generate_main_content(template, user_type, user_level, context),
            'examples': self._select_examples(template, user_type, user_level),
            'key_points': self._generate_key_points(template, user_level),
            'next_steps': self._generate_next_steps(template, user_type),
            'metadata': {
                'user_type': user_type,
                'user_level': user_level,
                'style': style,
                'generated_at': self._get_current_timestamp()
            }
        }
        
        return content
    
    def generate_theory_with_ui(self, state: TutorState) -> TutorState:
        """UI ëª¨ë“œ ê´€ë¦¬ì™€ í•¨ê»˜ ì´ë¡  ì½˜í…ì¸  ìƒì„±"""
        try:
            # ì‚¬ìš©ì ì…ë ¥ ìˆ˜ì‹  ì´ë²¤íŠ¸ ì²˜ë¦¬ (ë¡œë”© ìƒíƒœë¡œ ì „í™˜)
            state = StateManager.handle_ui_transition(
                state, "user_input_received", "theory_educator"
            )
            
            # ì´ë¡  ì½˜í…ì¸  ìƒì„±
            content = self.generate_theory_content(
                state['current_chapter'],
                state['user_type'],
                state['user_level'],
                state.get('user_message', '')
            )
            
            # ì‹œìŠ¤í…œ ë©”ì‹œì§€ ìƒì„±
            system_message = self._format_content_for_display(content)
            
            # ìƒíƒœ ì—…ë°ì´íŠ¸
            state['system_message'] = system_message
            state['current_stage'] = 'theory_complete'
            
            # ëŒ€í™” ê¸°ë¡ ì¶”ê°€
            state = StateManager.add_conversation(
                state, 
                "theory_educator",
                state.get('user_message', ''),
                system_message,
                {'content_data': content}
            )
            
            # UI ìƒíƒœ ì—…ë°ì´íŠ¸ (ì—ì´ì „íŠ¸ ì‘ë‹µ ì¤€ë¹„ ì™„ë£Œ)
            ui_context = {
                'title': content['title'],
                'description': 'ê°œë… ì„¤ëª…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì§ˆë¬¸í•˜ê±°ë‚˜ ë¬¸ì œë¥¼ í’€ì–´ë³´ì„¸ìš”.',
                'show_progress': True,
                'progress_value': self._calculate_progress(state),
                'content_type': 'theory'
            }
            
            state = StateManager.handle_ui_transition(
                state, "agent_response_ready", "theory_educator", ui_context
            )
            
        except Exception as e:
            # ì˜¤ë¥˜ ì²˜ë¦¬
            state['system_message'] = f"ì´ë¡  ì½˜í…ì¸  ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}"
            state = StateManager.handle_ui_transition(
                state, "error_occurred", "theory_educator", 
                {'error_message': str(e)}
            )
        
        return state
    
    def _generate_introduction(self, template: Dict[str, Any], 
                              user_type: str, user_level: str) -> str:
        """ë„ì…ë¶€ ìƒì„±"""
        
        title = template['title']
        
        if user_type == 'beginner':
            if user_level == 'low':
                return f"ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ '{title}'ì— ëŒ€í•´ ì‰½ê³  ì¬ë¯¸ìˆê²Œ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. ì–´ë ¤ìš´ ìš©ì–´ëŠ” ìµœëŒ€í•œ í”¼í•˜ê³ , ì¼ìƒìƒí™œì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ì˜ˆì‹œë“¤ë¡œ ì„¤ëª…í•´ë“œë¦´ê²Œìš”."
            else:
                return f"'{title}'ì— ëŒ€í•´ ì²´ê³„ì ìœ¼ë¡œ í•™ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤. ê¸°ë³¸ ê°œë…ë¶€í„° ì°¨ê·¼ì°¨ê·¼ ì„¤ëª…í•˜ì—¬ í™•ì‹¤íˆ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
        
        else:  # business
            if user_level == 'low':
                return f"ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì—ì„œ '{title}'ë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì‹¤ë¬´ì— ë°”ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” ë‚´ìš©ë“¤ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ëª…í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
            else:
                return f"'{title}'ì— ëŒ€í•œ ì‹¬í™” í•™ìŠµì„ ì‹œì‘í•˜ê² ìŠµë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ í™œìš© ì‚¬ë¡€ì™€ ì‹¤ì „ ì ìš© ë°©ë²•ì„ í¬í•¨í•˜ì—¬ í¬ê´„ì ìœ¼ë¡œ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤."
    
    def _generate_main_content(self, template: Dict[str, Any], 
                              user_type: str, user_level: str, context: str) -> List[Dict[str, str]]:
        """ë©”ì¸ ì½˜í…ì¸  ìƒì„±"""
        
        objectives = template['objectives']
        key_concepts = template['key_concepts']
        
        content_sections = []
        
        # ê° í•™ìŠµ ëª©í‘œë³„ë¡œ ì„¹ì…˜ ìƒì„±
        for i, objective in enumerate(objectives):
            section = {
                'section_number': i + 1,
                'title': self._generate_section_title(objective, user_level),
                'content': self._generate_section_content(objective, key_concepts, user_type, user_level),
                'concepts': [concept for concept in key_concepts if self._is_concept_relevant(concept, objective)]
            }
            content_sections.append(section)
        
        # ì»¨í…ìŠ¤íŠ¸ê°€ ìˆëŠ” ê²½ìš° ì¶”ê°€ ì„¹ì…˜ ìƒì„±
        if context:
            context_section = {
                'section_number': len(content_sections) + 1,
                'title': 'ì¶”ê°€ ì„¤ëª…',
                'content': self._generate_context_based_content(context, user_type, user_level),
                'concepts': []
            }
            content_sections.append(context_section)
        
        return content_sections
    
    def _generate_section_title(self, objective: str, user_level: str) -> str:
        """ì„¹ì…˜ ì œëª© ìƒì„±"""
        
        if user_level == 'low':
            # ì¹œê·¼í•œ ì œëª©
            title_map = {
                'AI, ML, DLì˜ ê°œë…ê³¼ ì°¨ì´ì  ì´í•´': 'ğŸ¤– AI, ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹ì´ ë­”ê°€ìš”?',
                'AIì˜ ì‹¤ìƒí™œ ì ìš© ì‚¬ë¡€ íŒŒì•…': 'ğŸ“± ìš°ë¦¬ ì£¼ë³€ì˜ AI ì°¾ì•„ë³´ê¸°',
                'AI ê¸°ìˆ ì˜ í•œê³„ì™€ ê°€ëŠ¥ì„± ì¸ì‹': 'ğŸ”® AIê°€ í•  ìˆ˜ ìˆëŠ” ê²ƒê³¼ ì—†ëŠ” ê²ƒ',
                'ì•½í•œ AIì™€ ê°•í•œ AIì˜ êµ¬ë¶„': 'ğŸ’ª ì•½í•œ AI vs ê°•í•œ AI',
                'ì§€ë„í•™ìŠµ, ë¹„ì§€ë„í•™ìŠµ, ê°•í™”í•™ìŠµ ì´í•´': 'ğŸ“š AIê°€ í•™ìŠµí•˜ëŠ” ë°©ë²•ë“¤',
                'ê° AI ìœ í˜•ì˜ í™œìš© ë¶„ì•¼ íŒŒì•…': 'ğŸ¯ ì–´ë–¤ AIë¥¼ ì–¸ì œ ì‚¬ìš©í• ê¹Œ?',
                'í”„ë¡¬í”„íŠ¸ì˜ ì •ì˜ì™€ ì¤‘ìš”ì„± ì´í•´': 'ğŸ’¬ í”„ë¡¬í”„íŠ¸ê°€ ë­ê¸¸ë˜?',
                'íš¨ê³¼ì ì¸ í”„ë¡¬í”„íŠ¸ ì‘ì„± ì›ì¹™ í•™ìŠµ': 'âœï¸ ì¢‹ì€ í”„ë¡¬í”„íŠ¸ ì‘ì„±ë²•',
                'ì‹¤ì œ í”„ë¡¬í”„íŠ¸ ì‘ì„± ë° í…ŒìŠ¤íŠ¸ ê²½í—˜': 'ğŸ§ª ì§ì ‘ í”„ë¡¬í”„íŠ¸ ë§Œë“¤ì–´ë³´ê¸°',
                'LLM(Large Language Model)ì˜ ì •ì˜ì™€ íŠ¹ì§• ì´í•´': 'ğŸ§  LLMì´ ë­”ê°€ìš”?',
                'GPT, BERT, Transformer êµ¬ì¡°ì˜ ê¸°ë³¸ ê°œë… íŒŒì•…': 'ğŸ”§ AI ëª¨ë¸ë“¤ì˜ êµ¬ì¡°',
                'LLMì˜ ë°œì „ ê³¼ì •ê³¼ ì£¼ìš” ëª¨ë¸ë“¤ì˜ ì°¨ì´ì  ì¸ì‹': 'ğŸ“ˆ LLMì˜ ë°œì „ ì—­ì‚¬',
                'ChatGPTì˜ ì£¼ìš” í™œìš© ë¶„ì•¼ì™€ ê¸°ëŠ¥ ì´í•´': 'ğŸš€ ChatGPT í™œìš©ë²•',
                'ìš”ì•½, ë²ˆì—­, ì§ˆë¬¸ ìƒì„± ë“± ì‹¤ìš©ì  ê¸°ëŠ¥ ì²´í—˜': 'âš¡ ì‹¤ìš©ì  ê¸°ëŠ¥ë“¤',
                'ì—…ë¬´ íš¨ìœ¨ì„± í–¥ìƒì„ ìœ„í•œ ChatGPT í™œìš©ë²• í•™ìŠµ': 'ğŸ’¼ ì—…ë¬´ì— í™œìš©í•˜ê¸°',
                'AI ê¸°ìˆ ì˜ ìœ¤ë¦¬ì  ê³ ë ¤ì‚¬í•­ ì´í•´': 'âš–ï¸ AI ìœ¤ë¦¬',
                'AIì˜ í˜„ì¬ í•œê³„ì™€ ë¯¸ë˜ ë°œì „ ë°©í–¥ íŒŒì•…': 'ğŸ”® AIì˜ í•œê³„ì™€ ë¯¸ë˜',
                'AI ì‹œëŒ€ì— í•„ìš”í•œ ìƒˆë¡œìš´ ì—­ëŸ‰ê³¼ ì§„ë¡œ íƒìƒ‰': 'ğŸ’ª ë¯¸ë˜ ì—­ëŸ‰ ê¸°ë¥´ê¸°'
            }
        else:
            # ì „ë¬¸ì ì¸ ì œëª©
            title_map = {
                'AI, ML, DLì˜ ê°œë…ê³¼ ì°¨ì´ì  ì´í•´': 'ì¸ê³µì§€ëŠ¥, ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹ì˜ ê°œë… ì •ì˜',
                'AIì˜ ì‹¤ìƒí™œ ì ìš© ì‚¬ë¡€ íŒŒì•…': 'ì¸ê³µì§€ëŠ¥ì˜ ì‹¤ìƒí™œ ì ìš© ì‚¬ë¡€ ë¶„ì„',
                'AI ê¸°ìˆ ì˜ í•œê³„ì™€ ê°€ëŠ¥ì„± ì¸ì‹': 'ì¸ê³µì§€ëŠ¥ ê¸°ìˆ ì˜ í˜„ì¬ í•œê³„ì™€ ë¯¸ë˜ ê°€ëŠ¥ì„±',
                'ì•½í•œ AIì™€ ê°•í•œ AIì˜ êµ¬ë¶„': 'ì•½í•œ ì¸ê³µì§€ëŠ¥ê³¼ ê°•í•œ ì¸ê³µì§€ëŠ¥ì˜ ì°¨ì´ì ',
                'ì§€ë„í•™ìŠµ, ë¹„ì§€ë„í•™ìŠµ, ê°•í™”í•™ìŠµ ì´í•´': 'ë¨¸ì‹ ëŸ¬ë‹ì˜ ì£¼ìš” í•™ìŠµ ë°©ë²•ë¡ ',
                'ê° AI ìœ í˜•ì˜ í™œìš© ë¶„ì•¼ íŒŒì•…': 'AI ìœ í˜•ë³„ ì ìš© ë¶„ì•¼ ë° í™œìš© ì‚¬ë¡€',
                'í”„ë¡¬í”„íŠ¸ì˜ ì •ì˜ì™€ ì¤‘ìš”ì„± ì´í•´': 'í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì˜ ê¸°ì´ˆ',
                'íš¨ê³¼ì ì¸ í”„ë¡¬í”„íŠ¸ ì‘ì„± ì›ì¹™ í•™ìŠµ': 'íš¨ê³¼ì ì¸ í”„ë¡¬í”„íŠ¸ ì„¤ê³„ ì›ì¹™',
                'ì‹¤ì œ í”„ë¡¬í”„íŠ¸ ì‘ì„± ë° í…ŒìŠ¤íŠ¸ ê²½í—˜': 'í”„ë¡¬í”„íŠ¸ ì‘ì„± ì‹¤ìŠµ ë° ìµœì í™”',
                'LLM(Large Language Model)ì˜ ì •ì˜ì™€ íŠ¹ì§• ì´í•´': 'Large Language Model ê°œìš”',
                'GPT, BERT, Transformer êµ¬ì¡°ì˜ ê¸°ë³¸ ê°œë… íŒŒì•…': 'ì£¼ìš” LLM ì•„í‚¤í…ì²˜ ë¶„ì„',
                'LLMì˜ ë°œì „ ê³¼ì •ê³¼ ì£¼ìš” ëª¨ë¸ë“¤ì˜ ì°¨ì´ì  ì¸ì‹': 'LLM ë°œì „ì‚¬ ë° ëª¨ë¸ ë¹„êµ',
                'ChatGPTì˜ ì£¼ìš” í™œìš© ë¶„ì•¼ì™€ ê¸°ëŠ¥ ì´í•´': 'ChatGPT ê¸°ëŠ¥ ë° í™œìš© ë¶„ì•¼',
                'ìš”ì•½, ë²ˆì—­, ì§ˆë¬¸ ìƒì„± ë“± ì‹¤ìš©ì  ê¸°ëŠ¥ ì²´í—˜': 'í•µì‹¬ ê¸°ëŠ¥ë³„ í™œìš© ì „ëµ',
                'ì—…ë¬´ íš¨ìœ¨ì„± í–¥ìƒì„ ìœ„í•œ ChatGPT í™œìš©ë²• í•™ìŠµ': 'ë¹„ì¦ˆë‹ˆìŠ¤ í”„ë¡œì„¸ìŠ¤ ìµœì í™”',
                'AI ê¸°ìˆ ì˜ ìœ¤ë¦¬ì  ê³ ë ¤ì‚¬í•­ ì´í•´': 'AI ìœ¤ë¦¬ ë° ì±…ì„ê° ìˆëŠ” AI',
                'AIì˜ í˜„ì¬ í•œê³„ì™€ ë¯¸ë˜ ë°œì „ ë°©í–¥ íŒŒì•…': 'AI ê¸°ìˆ ì˜ í˜„ì¬ í•œê³„ì™€ ë°œì „ ì „ë§',
                'AI ì‹œëŒ€ì— í•„ìš”í•œ ìƒˆë¡œìš´ ì—­ëŸ‰ê³¼ ì§„ë¡œ íƒìƒ‰': 'ë¯¸ë˜ ì¸ì¬ ì—­ëŸ‰ ë° ì§„ë¡œ ê°œë°œ'
            }
        
        return title_map.get(objective, objective)
    
    def _generate_section_content(self, objective: str, key_concepts: List[str], 
                                 user_type: str, user_level: str) -> str:
        """ì„¹ì…˜ ì½˜í…ì¸  ìƒì„±"""
        
        # ê°„ë‹¨í•œ í…œí”Œë¦¿ ê¸°ë°˜ ì½˜í…ì¸  ìƒì„±
        # ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ë” ì •êµí•œ ì½˜í…ì¸  ìƒì„± ë¡œì§ í•„ìš”
        
        if 'AI, ML, DL' in objective:
            if user_level == 'low':
                return """
AI(ì¸ê³µì§€ëŠ¥)ëŠ” ì»´í“¨í„°ê°€ ì‚¬ëŒì²˜ëŸ¼ ìƒê°í•˜ê³  íŒë‹¨í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.

ğŸ¤– **AI (ì¸ê³µì§€ëŠ¥)**: ì»´í“¨í„°ê°€ ì‚¬ëŒì²˜ëŸ¼ ë˜‘ë˜‘í•˜ê²Œ í–‰ë™í•˜ëŠ” ê²ƒ
- ì˜ˆ: ìŠ¤ë§ˆíŠ¸í° ìŒì„±ì¸ì‹, ë²ˆì—­ ì•±

ğŸ“Š **ML (ë¨¸ì‹ ëŸ¬ë‹)**: AIì˜ í•œ ë°©ë²•ìœ¼ë¡œ, ì»´í“¨í„°ê°€ ë°ì´í„°ë¥¼ ë³´ê³  ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•˜ëŠ” ê²ƒ
- ì˜ˆ: ë„·í”Œë¦­ìŠ¤ê°€ ë‚´ê°€ ì¢‹ì•„í•  ì˜í™”ë¥¼ ì¶”ì²œí•˜ëŠ” ê²ƒ

ğŸ§  **DL (ë”¥ëŸ¬ë‹)**: ë¨¸ì‹ ëŸ¬ë‹ì˜ í•œ ë°©ë²•ìœ¼ë¡œ, ì‚¬ëŒì˜ ë‡Œë¥¼ ëª¨ë°©í•œ ë°©ì‹
- ì˜ˆ: ì‚¬ì§„ì—ì„œ ì–¼êµ´ì„ ì°¾ì•„ë‚´ëŠ” ê²ƒ

ì‰½ê²Œ ë§í•´ì„œ: AI > ML > DL ìˆœì„œë¡œ í¬í•¨ê´€ê³„ì…ë‹ˆë‹¤!
                """
            else:
                return """
ì¸ê³µì§€ëŠ¥(AI), ë¨¸ì‹ ëŸ¬ë‹(ML), ë”¥ëŸ¬ë‹(DL)ì€ ì„œë¡œ ì—°ê´€ë˜ì–´ ìˆì§€ë§Œ êµ¬ë³„ë˜ëŠ” ê°œë…ì…ë‹ˆë‹¤.

**ì¸ê³µì§€ëŠ¥ (Artificial Intelligence)**
- ì •ì˜: ì¸ê°„ì˜ ì§€ëŠ¥ì„ ëª¨ë°©í•˜ì—¬ í•™ìŠµ, ì¶”ë¡ , íŒë‹¨ ë“±ì„ ìˆ˜í–‰í•˜ëŠ” ì»´í“¨í„° ì‹œìŠ¤í…œ
- ë²”ìœ„: ê°€ì¥ ë„“ì€ ê°œë…ìœ¼ë¡œ ëª¨ë“  ì§€ëŠ¥ì  í–‰ë™ì„ í¬í•¨

**ë¨¸ì‹ ëŸ¬ë‹ (Machine Learning)**
- ì •ì˜: ëª…ì‹œì  í”„ë¡œê·¸ë˜ë° ì—†ì´ ë°ì´í„°ë¡œë¶€í„° íŒ¨í„´ì„ í•™ìŠµí•˜ëŠ” AIì˜ í•˜ìœ„ ë¶„ì•¼
- íŠ¹ì§•: ê²½í—˜ì„ í†µí•´ ì„±ëŠ¥ì´ í–¥ìƒë˜ëŠ” ì•Œê³ ë¦¬ì¦˜

**ë”¥ëŸ¬ë‹ (Deep Learning)**
- ì •ì˜: ì¸ê³µì‹ ê²½ë§ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ë¨¸ì‹ ëŸ¬ë‹ì˜ íŠ¹ìˆ˜í•œ í˜•íƒœ
- íŠ¹ì§•: ë‹¤ì¸µ ì‹ ê²½ë§ì„ í†µí•´ ë³µì¡í•œ íŒ¨í„´ ì¸ì‹ ê°€ëŠ¥

**ê´€ê³„**: AI âŠƒ ML âŠƒ DL (í¬í•¨ê´€ê³„)
                """
        
        elif 'LLM' in objective or 'GPT' in objective or 'BERT' in objective or 'Transformer' in objective:
            if user_level == 'low':
                return """
LLMì€ 'Large Language Model'ì˜ ì¤„ì„ë§ë¡œ, ì•„ì£¼ í° ì–¸ì–´ ëª¨ë¸ì´ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.

ğŸ§  **LLMì´ë€?**
- ì—„ì²­ë‚˜ê²Œ ë§ì€ í…ìŠ¤íŠ¸ë¥¼ í•™ìŠµí•œ AI ëª¨ë¸
- ì‚¬ëŒì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ê¸€ì„ ì½ê³  ì“¸ ìˆ˜ ìˆì–´ìš”
- ì˜ˆ: ChatGPT, Google Bard, Claude

ğŸ“š **ì£¼ìš” LLM ëª¨ë¸ë“¤**
- **GPT**: OpenAIì—ì„œ ë§Œë“  ëŒ€í™”í˜• AI (ChatGPTì˜ ê¸°ë°˜)
- **BERT**: Googleì—ì„œ ë§Œë“  í…ìŠ¤íŠ¸ ì´í•´ ì „ë¬¸ AI
- **Transformer**: ëª¨ë“  LLMì˜ ê¸°ë³¸ì´ ë˜ëŠ” êµ¬ì¡°

ğŸ”§ **ì–´ë–»ê²Œ ì‘ë™í•˜ë‚˜ìš”?**
1. ì¸í„°ë„·ì˜ ìˆ˜ë§ì€ ê¸€ì„ ì½ê³  í•™ìŠµ
2. ë‹¨ì–´ë“¤ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ íŒŒì•…
3. ìƒˆë¡œìš´ ì§ˆë¬¸ì— ì ì ˆí•œ ë‹µë³€ ìƒì„±

ğŸ’¡ **ì™œ ëŒ€ë‹¨í•œê°€ìš”?**
- ë²ˆì—­, ìš”ì•½, ì°½ì‘ ë“± ë‹¤ì–‘í•œ ì¼ì„ í•œ ë²ˆì—!
- ì‚¬ëŒê³¼ ìì—°ìŠ¤ëŸ½ê²Œ ëŒ€í™” ê°€ëŠ¥
                """
            else:
                return """
Large Language Model(LLM)ì€ ëŒ€ê·œëª¨ í…ìŠ¤íŠ¸ ë°ì´í„°ë¡œ ì‚¬ì „í›ˆë ¨ëœ ì‹ ê²½ë§ ëª¨ë¸ì…ë‹ˆë‹¤.

**LLMì˜ í•µì‹¬ íŠ¹ì§•**
- **ê·œëª¨**: ìˆ˜ì‹­ì–µ~ìˆ˜ì¡° ê°œì˜ íŒŒë¼ë¯¸í„°ë¡œ êµ¬ì„±
- **ì‚¬ì „í›ˆë ¨**: ì¸í„°ë„· í…ìŠ¤íŠ¸ë¡œ ì–¸ì–´ì˜ í†µê³„ì  íŒ¨í„´ í•™ìŠµ
- **ë²”ìš©ì„±**: ë‹¤ì–‘í•œ ìì—°ì–´ ì²˜ë¦¬ íƒœìŠ¤í¬ì— ì ìš© ê°€ëŠ¥

**ì£¼ìš” ì•„í‚¤í…ì²˜**
1. **Transformer**: ì–´í…ì…˜ ë©”ì»¤ë‹ˆì¦˜ ê¸°ë°˜ì˜ ê¸°ë³¸ êµ¬ì¡°
   - ë³‘ë ¬ ì²˜ë¦¬ ê°€ëŠ¥, ì¥ê±°ë¦¬ ì˜ì¡´ì„± í¬ì°©
   - Encoder-Decoder ë˜ëŠ” Decoder-only êµ¬ì¡°

2. **GPT (Generative Pre-trained Transformer)**
   - Decoder-only êµ¬ì¡°, ìê¸°íšŒê·€ì  í…ìŠ¤íŠ¸ ìƒì„±
   - ëŒ€í™”í˜• AIì˜ ê¸°ë°˜ ëª¨ë¸

3. **BERT (Bidirectional Encoder Representations)**
   - Encoder-only êµ¬ì¡°, ì–‘ë°©í–¥ ì»¨í…ìŠ¤íŠ¸ ì´í•´
   - í…ìŠ¤íŠ¸ ë¶„ë¥˜, ì§ˆì˜ì‘ë‹µì— íŠ¹í™”

**ë°œì „ ê³¼ì •**
- GPT-1 (2018) â†’ GPT-2 (2019) â†’ GPT-3 (2020) â†’ GPT-4 (2023)
- íŒŒë¼ë¯¸í„° ìˆ˜ì™€ ì„±ëŠ¥ì˜ ì§€ì†ì  í–¥ìƒ
- Few-shot, Zero-shot í•™ìŠµ ëŠ¥ë ¥ íšë“
                """
        
        elif 'í”„ë¡¬í”„íŠ¸' in objective:
            if user_level == 'low':
                return """
í”„ë¡¬í”„íŠ¸ëŠ” AIì—ê²Œ ì£¼ëŠ” 'ëª…ë ¹ì–´'ë‚˜ 'ì§ˆë¬¸'ì…ë‹ˆë‹¤.

ğŸ’¬ **í”„ë¡¬í”„íŠ¸ë€?**
- AI(ChatGPT ê°™ì€)ì—ê²Œ ë¬´ì—‡ì„ í•´ë‹¬ë¼ê³  ë§í•˜ëŠ” ê²ƒ
- ì˜ˆ: "ì˜¤ëŠ˜ ë‚ ì”¨ ì–´ë•Œ?", "ì´ë©”ì¼ ì¨ì¤˜"

âœ¨ **ì™œ ì¤‘ìš”í•œê°€ìš”?**
- í”„ë¡¬í”„íŠ¸ë¥¼ ì˜ ì“°ë©´ â†’ AIê°€ ë” ì¢‹ì€ ë‹µë³€ì„ í•´ì¤˜ìš”
- í”„ë¡¬í”„íŠ¸ë¥¼ ëŒ€ì¶© ì“°ë©´ â†’ AIê°€ ì—‰ëš±í•œ ë‹µë³€ì„ í•  ìˆ˜ ìˆì–´ìš”

ğŸ“ **ì¢‹ì€ í”„ë¡¬í”„íŠ¸ì˜ íŠ¹ì§•**
1. ëª…í™•í•˜ê²Œ: "ë­”ê°€ ì¨ì¤˜" âŒ â†’ "íšŒì˜ ìš”ì•½ ì´ë©”ì¼ ì¨ì¤˜" âœ…
2. êµ¬ì²´ì ìœ¼ë¡œ: "ê¸€ ì¨ì¤˜" âŒ â†’ "500ì ë¸”ë¡œê·¸ ê¸€ ì¨ì¤˜" âœ…
3. ì˜ˆì‹œ í¬í•¨: "ì´ëŸ° ì‹ìœ¼ë¡œ ì¨ì¤˜: [ì˜ˆì‹œ]"
                """
            else:
                return """
í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì€ LLMê³¼ì˜ íš¨ê³¼ì ì¸ ìƒí˜¸ì‘ìš©ì„ ìœ„í•œ í•µì‹¬ ê¸°ìˆ ì…ë‹ˆë‹¤.

**í”„ë¡¬í”„íŠ¸ì˜ ì •ì˜**
- Large Language Model(LLM)ì— ì…ë ¥í•˜ëŠ” í…ìŠ¤íŠ¸ ëª…ë ¹ì–´
- ëª¨ë¸ì˜ ì¶œë ¥ì„ ì œì–´í•˜ê³  ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤

**í”„ë¡¬í”„íŠ¸ì˜ ì¤‘ìš”ì„±**
1. **ì¶œë ¥ í’ˆì§ˆ ê²°ì •**: ë™ì¼í•œ ëª¨ë¸ë„ í”„ë¡¬í”„íŠ¸ì— ë”°ë¼ ê²°ê³¼ê°€ í¬ê²Œ ë‹¬ë¼ì§
2. **íš¨ìœ¨ì„± í–¥ìƒ**: ì ì ˆí•œ í”„ë¡¬í”„íŠ¸ë¡œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ë¹ ë¥´ê²Œ íšë“
3. **ë¹„ìš© ìµœì í™”**: íš¨ê³¼ì ì¸ í”„ë¡¬í”„íŠ¸ë¡œ API í˜¸ì¶œ íšŸìˆ˜ ê°ì†Œ

**í”„ë¡¬í”„íŠ¸ ì„¤ê³„ ì›ì¹™**
- **ëª…í™•ì„±**: ëª¨í˜¸í•˜ì§€ ì•Šì€ êµ¬ì²´ì  ì§€ì‹œì‚¬í•­
- **ë§¥ë½ ì œê³µ**: ì¶©ë¶„í•œ ë°°ê²½ ì •ë³´ì™€ ì˜ˆì‹œ
- **êµ¬ì¡°í™”**: ë…¼ë¦¬ì  ìˆœì„œì™€ ëª…í™•í•œ í˜•ì‹
- **ì œì•½ ì¡°ê±´**: ì¶œë ¥ ê¸¸ì´, í˜•ì‹, í†¤ ë“±ì˜ ëª…ì‹œ
                """
        
        elif 'ChatGPT' in objective or 'ìš”ì•½' in objective or 'ë²ˆì—­' in objective or 'ì§ˆë¬¸ ìƒì„±' in objective:
            if user_level == 'low':
                return """
ChatGPTëŠ” ì •ë§ ë‹¤ì–‘í•œ ì¼ì„ í•  ìˆ˜ ìˆëŠ” ë§ŒëŠ¥ AI ë„ìš°ë¯¸ì…ë‹ˆë‹¤!

ğŸ“ **í…ìŠ¤íŠ¸ ì‘ì—…**
- **ìš”ì•½í•˜ê¸°**: ê¸´ ê¸€ì„ ì§§ê²Œ ì •ë¦¬í•´ì¤˜ìš”
  - "ì´ ê¸°ì‚¬ë¥¼ 3ì¤„ë¡œ ìš”ì•½í•´ì¤˜"
- **ë²ˆì—­í•˜ê¸°**: ë‹¤ë¥¸ ì–¸ì–´ë¡œ ë²ˆì—­í•´ì¤˜ìš”
  - "ì´ ë¬¸ì¥ì„ ì˜ì–´ë¡œ ë²ˆì—­í•´ì¤˜"
- **ê¸€ì“°ê¸°**: ì´ë©”ì¼, í¸ì§€, ë³´ê³ ì„œ ë“±ì„ ì¨ì¤˜ìš”
  - "ê°ì‚¬ ì¸ì‚¬ ì´ë©”ì¼ ì¨ì¤˜"

ğŸ¤” **ì•„ì´ë””ì–´ ë„ìš°ë¯¸**
- **ì§ˆë¬¸ ë§Œë“¤ê¸°**: ê³µë¶€í•  ë•Œ ë¬¸ì œë¥¼ ë§Œë“¤ì–´ì¤˜ìš”
- **ì•„ì´ë””ì–´ ìƒì„±**: ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¥¼ ì œì•ˆí•´ì¤˜ìš”
- **ê³„íš ì„¸ìš°ê¸°**: ì—¬í–‰, ê³µë¶€ ê³„íšì„ ë„ì™€ì¤˜ìš”

ğŸ’» **ì‹¤ìš©ì  í™œìš©**
- **ì„¤ëª…í•˜ê¸°**: ì–´ë ¤ìš´ ê°œë…ì„ ì‰½ê²Œ ì„¤ëª…
- **ê²€í† í•˜ê¸°**: ë‚´ê°€ ì“´ ê¸€ì„ í™•ì¸í•˜ê³  ê°œì„ ì  ì œì•ˆ
- **ëŒ€í™”í•˜ê¸°**: ê¶ê¸ˆí•œ ê²ƒì„ ììœ ë¡­ê²Œ ë¬¼ì–´ë³´ê¸°

ğŸ’¡ **íŒ**: êµ¬ì²´ì ìœ¼ë¡œ ìš”ì²­í• ìˆ˜ë¡ ë” ì¢‹ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì–´ìš”!
                """
            else:
                return """
ChatGPTëŠ” ë‹¤ì–‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ íƒœìŠ¤í¬ì—ì„œ ìƒì‚°ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

**í•µì‹¬ í™œìš© ë¶„ì•¼**

1. **ë¬¸ì„œ ì‘ì—… ìë™í™”**
   - íšŒì˜ë¡ ìš”ì•½ ë° ì•¡ì…˜ ì•„ì´í…œ ì¶”ì¶œ
   - ë³´ê³ ì„œ ì´ˆì•ˆ ì‘ì„± ë° êµ¬ì¡°í™”
   - ì´ë©”ì¼ í…œí”Œë¦¿ ìƒì„± ë° ê°œì¸í™”

2. **ì½˜í…ì¸  ìƒì„± ë° í¸ì§‘**
   - ë§ˆì¼€íŒ… ì¹´í”¼ ë° ì œì•ˆì„œ ì‘ì„±
   - ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ë° ì†Œì…œë¯¸ë””ì–´ ì½˜í…ì¸ 
   - í”„ë ˆì  í…Œì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ê°œë°œ

3. **ë°ì´í„° ë¶„ì„ ì§€ì›**
   - ë³µì¡í•œ ë°ì´í„° í•´ì„ ë° ì¸ì‚¬ì´íŠ¸ ë„ì¶œ
   - ì°¨íŠ¸ ë° ê·¸ë˜í”„ ì„¤ëª… ìƒì„±
   - íŠ¸ë Œë“œ ë¶„ì„ ë° ì˜ˆì¸¡ ë³´ê³ ì„œ

4. **ê³ ê° ì„œë¹„ìŠ¤ í–¥ìƒ**
   - FAQ ìë™ ìƒì„± ë° ì—…ë°ì´íŠ¸
   - ê³ ê° ë¬¸ì˜ ì‘ë‹µ í…œí”Œë¦¿ ì‘ì„±
   - ë‹¤êµ­ì–´ ê³ ê° ì§€ì› ì½˜í…ì¸  ë²ˆì—­

**íš¨ê³¼ì  í™œìš© ì „ëµ**
- **ëª…í™•í•œ ì—­í•  ì •ì˜**: "ë§ˆì¼€íŒ… ì „ë¬¸ê°€ë¡œì„œ..." ë“± ì—­í•  ë¶€ì—¬
- **êµ¬ì²´ì  ìš”êµ¬ì‚¬í•­**: í˜•ì‹, ê¸¸ì´, í†¤ì•¤ë§¤ë„ˆ ëª…ì‹œ
- **ë°˜ë³µì  ê°œì„ **: í”¼ë“œë°±ì„ í†µí•œ ì ì§„ì  í’ˆì§ˆ í–¥ìƒ
                """
        
        elif 'AI ìœ¤ë¦¬' in objective or 'í•œê³„' in objective or 'ë¯¸ë˜' in objective or 'ë¬¸í•´ë ¥' in objective:
            if user_level == 'low':
                return """
AIê°€ ë°œì „í•˜ë©´ì„œ ìš°ë¦¬ê°€ ì•Œì•„ì•¼ í•  ì¤‘ìš”í•œ ê²ƒë“¤ì´ ìˆì–´ìš”.

âš–ï¸ **AI ìœ¤ë¦¬ - ê³µì •í•˜ê²Œ ì‚¬ìš©í•˜ê¸°**
- AIë„ í¸ê²¬ì„ ê°€ì§ˆ ìˆ˜ ìˆì–´ìš” (í•™ìŠµ ë°ì´í„°ì˜ í¸í–¥)
- ê°œì¸ì •ë³´ë¥¼ ë³´í˜¸í•´ì•¼ í•´ìš”
- AIê°€ ë§Œë“  ë‚´ìš©ì„ì„ ë°í˜€ì•¼ í•´ìš”

ğŸš« **AIì˜ í•œê³„**
- í•­ìƒ ì •í™•í•˜ì§€ëŠ” ì•Šì•„ìš” (í• ë£¨ì‹œë„¤ì´ì…˜)
- ìµœì‹  ì •ë³´ë¥¼ ëª¨ë¥¼ ìˆ˜ ìˆì–´ìš”
- ê°ì •ì´ë‚˜ ì°½ì˜ì„±ì—ëŠ” í•œê³„ê°€ ìˆì–´ìš”

ğŸ”® **ë¯¸ë˜ì˜ ë³€í™”**
- ìƒˆë¡œìš´ ì§ì—…ë“¤ì´ ìƒê²¨ë‚  ê±°ì˜ˆìš”
- AIì™€ í•¨ê»˜ ì¼í•˜ëŠ” ëŠ¥ë ¥ì´ ì¤‘ìš”í•´ì ¸ìš”
- í‰ìƒí•™ìŠµì´ ë”ìš± ì¤‘ìš”í•´ì ¸ìš”

ğŸ’ª **ìš°ë¦¬ê°€ ì¤€ë¹„í•´ì•¼ í•  ê²ƒ**
- AI ë„êµ¬ ì‚¬ìš©ë²• ìµíˆê¸°
- ë¹„íŒì  ì‚¬ê³ ë ¥ ê¸°ë¥´ê¸°
- ì°½ì˜ì„±ê³¼ ì†Œí†µ ëŠ¥ë ¥ ê°œë°œí•˜ê¸°

ğŸŒŸ **AI ì‹œëŒ€ì˜ ë¬¸í•´ë ¥**
- AIê°€ ë§Œë“  ì •ë³´ë¥¼ êµ¬ë³„í•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥
- AIë¥¼ ë„êµ¬ë¡œ í™œìš©í•˜ëŠ” ëŠ¥ë ¥
- ìœ¤ë¦¬ì ìœ¼ë¡œ AIë¥¼ ì‚¬ìš©í•˜ëŠ” ëŠ¥ë ¥
                """
            else:
                return """
AI ê¸°ìˆ ì˜ ê¸‰ì†í•œ ë°œì „ì€ ì‚¬íšŒ ì „ë°˜ì— ê±¸ì³ ê·¼ë³¸ì ì¸ ë³€í™”ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤.

**AI ìœ¤ë¦¬ì˜ í•µì‹¬ ì´ìŠˆ**

1. **ì•Œê³ ë¦¬ì¦˜ í¸í–¥ì„± (Algorithmic Bias)**
   - í›ˆë ¨ ë°ì´í„°ì˜ í¸í–¥ì´ AI ê²°ê³¼ì— ë°˜ì˜
   - ì„±ë³„, ì¸ì¢…, ì—°ë ¹ ë“±ì— ëŒ€í•œ ì°¨ë³„ì  ê²°ê³¼ ê°€ëŠ¥
   - ê³µì •ì„± í™•ë³´ë¥¼ ìœ„í•œ ë‹¤ì–‘ì„± ìˆëŠ” ë°ì´í„°ì…‹ í•„ìš”

2. **ê°œì¸ì •ë³´ë³´í˜¸ ë° í”„ë¼ì´ë²„ì‹œ**
   - ëŒ€ê·œëª¨ ê°œì¸ ë°ì´í„° ìˆ˜ì§‘ ë° í™œìš©
   - GDPR, ê°œì¸ì •ë³´ë³´í˜¸ë²• ë“± ê·œì œ ì¤€ìˆ˜
   - ë°ì´í„° ìµœì†Œí™” ë° ëª©ì  ì œí•œ ì›ì¹™

3. **íˆ¬ëª…ì„± ë° ì„¤ëª…ê°€ëŠ¥ì„±**
   - ë¸”ë™ë°•ìŠ¤ ë¬¸ì œ: AI ì˜ì‚¬ê²°ì • ê³¼ì •ì˜ ë¶ˆíˆ¬ëª…ì„±
   - ì„¤ëª…ê°€ëŠ¥í•œ AI(XAI) ê¸°ìˆ  ê°œë°œ í•„ìš”
   - ì•Œê³ ë¦¬ì¦˜ ê°ì‚¬ ë° ì±…ì„ì„± í™•ë³´

**í˜„ì¬ ê¸°ìˆ ì˜ í•œê³„**
- **í• ë£¨ì‹œë„¤ì´ì…˜**: ê·¸ëŸ´ë“¯í•˜ì§€ë§Œ ì˜ëª»ëœ ì •ë³´ ìƒì„±
- **ì»¨í…ìŠ¤íŠ¸ ì´í•´ ë¶€ì¡±**: ìƒí™©ì  ë§¥ë½ íŒŒì•…ì˜ í•œê³„
- **ì¼ê´€ì„± ë¶€ì¡±**: ìœ ì‚¬í•œ ì§ˆë¬¸ì— ë‹¤ë¥¸ ë‹µë³€

**ë¯¸ë˜ ì „ë§ ë° ëŒ€ì‘ ì „ëµ**
- **ì¸ê°„-AI í˜‘ì—… ëª¨ë¸**: AIê°€ ì¸ê°„ì„ ëŒ€ì²´í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë³´ì™„
- **ìƒˆë¡œìš´ ì—­ëŸ‰ ìš”êµ¬**: ë””ì§€í„¸ ë¦¬í„°ëŸ¬ì‹œ, AI ë¦¬í„°ëŸ¬ì‹œ
- **ì§€ì†ì  í•™ìŠµ**: ê¸°ìˆ  ë³€í™”ì— ì ì‘í•˜ëŠ” í‰ìƒí•™ìŠµ ì²´ê³„
                """
        
        # ê¸°ë³¸ í…œí”Œë¦¿
        return f"{objective}ì— ëŒ€í•œ ìƒì„¸í•œ ì„¤ëª…ì´ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤. ì‚¬ìš©ì ë ˆë²¨({user_level})ê³¼ íƒ€ì…({user_type})ì— ë§ì¶° ì¡°ì •ëœ ë‚´ìš©ì…ë‹ˆë‹¤."
    
    def _select_examples(self, template: Dict[str, Any], 
                        user_type: str, user_level: str) -> List[str]:
        """ì‚¬ìš©ì íƒ€ì…ì— ë§ëŠ” ì˜ˆì‹œ ì„ íƒ"""
        
        examples = template.get('examples', {})
        user_examples = examples.get(user_type, [])
        
        # ë ˆë²¨ì— ë”°ë¼ ì˜ˆì‹œ ê°œìˆ˜ ì¡°ì •
        if user_level == 'low':
            return user_examples[:2]  # ê°„ë‹¨íˆ 2ê°œë§Œ
        elif user_level == 'medium':
            return user_examples[:3]  # 3ê°œ
        else:
            return user_examples  # ëª¨ë“  ì˜ˆì‹œ
    
    def _generate_key_points(self, template: Dict[str, Any], user_level: str) -> List[str]:
        """í•µì‹¬ í¬ì¸íŠ¸ ìƒì„±"""
        
        key_concepts = template.get('key_concepts', [])
        objectives = template.get('objectives', [])
        
        key_points = []
        
        # ì£¼ìš” ê°œë…ë“¤ì„ í•µì‹¬ í¬ì¸íŠ¸ë¡œ ë³€í™˜
        for concept in key_concepts[:3]:  # ìµœëŒ€ 3ê°œ
            if user_level == 'low':
                key_points.append(f"ğŸ’¡ {concept}ì˜ ê¸°ë³¸ ê°œë… ì´í•´")
            else:
                key_points.append(f"ğŸ“Œ {concept}ì˜ ì •ì˜ì™€ íŠ¹ì§• íŒŒì•…")
        
        # í•™ìŠµ ëª©í‘œë¥¼ í•µì‹¬ í¬ì¸íŠ¸ë¡œ ì¶”ê°€
        for objective in objectives[:2]:  # ìµœëŒ€ 2ê°œ
            key_points.append(f"ğŸ¯ {objective}")
        
        return key_points
    
    def _generate_next_steps(self, template: Dict[str, Any], user_type: str) -> List[str]:
        """ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ"""
        
        next_steps = []
        
        if user_type == 'beginner':
            next_steps = [
                "ğŸ¤” ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ë©´ ì–¸ì œë“  ì§ˆë¬¸í•´ë³´ì„¸ìš”",
                "ğŸ“ í•™ìŠµí•œ ë‚´ìš©ì„ í™•ì¸í•˜ëŠ” í€´ì¦ˆë¥¼ í’€ì–´ë³´ì„¸ìš”",
                "ğŸ’¡ ì‹¤ìƒí™œì—ì„œ ê´€ë ¨ ì‚¬ë¡€ë¥¼ ì°¾ì•„ë³´ì„¸ìš”"
            ]
        else:  # business
            next_steps = [
                "ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ì ìš© ë°©ì•ˆì„ êµ¬ì²´ì ìœ¼ë¡œ ìƒê°í•´ë³´ì„¸ìš”",
                "ğŸ“Š ì‹¤ë¬´ ì‚¬ë¡€ë¥¼ í†µí•œ ë¬¸ì œ í•´ê²° ì—°ìŠµì„ í•´ë³´ì„¸ìš”",
                "ğŸ” ì‹¬í™” í•™ìŠµì„ ìœ„í•œ ì¶”ê°€ ì§ˆë¬¸ì„ í•´ë³´ì„¸ìš”"
            ]
        
        return next_steps
    
    def _generate_fallback_content(self, chapter: int, user_type: str, user_level: str) -> Dict[str, Any]:
        """ê¸°ë³¸ ì½˜í…ì¸  ìƒì„± (í…œí”Œë¦¿ì´ ì—†ëŠ” ê²½ìš°)"""
        
        return {
            'chapter': chapter,
            'title': f'ì±•í„° {chapter} í•™ìŠµ',
            'introduction': f'ì±•í„° {chapter}ì˜ ë‚´ìš©ì„ í•™ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.',
            'main_content': [{
                'section_number': 1,
                'title': 'ê¸°ë³¸ ê°œë…',
                'content': f'ì±•í„° {chapter}ì˜ ê¸°ë³¸ ê°œë…ì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤.',
                'concepts': []
            }],
            'examples': ['ì˜ˆì‹œ 1', 'ì˜ˆì‹œ 2'],
            'key_points': ['í•µì‹¬ í¬ì¸íŠ¸ 1', 'í•µì‹¬ í¬ì¸íŠ¸ 2'],
            'next_steps': ['ë‹¤ìŒ ë‹¨ê³„ 1', 'ë‹¤ìŒ ë‹¨ê³„ 2'],
            'metadata': {
                'user_type': user_type,
                'user_level': user_level,
                'is_fallback': True,
                'generated_at': self._get_current_timestamp()
            }
        }
    
    def _generate_context_based_content(self, context: str, user_type: str, user_level: str) -> str:
        """ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ ì¶”ê°€ ì½˜í…ì¸  ìƒì„±"""
        
        # ê°„ë‹¨í•œ ì»¨í…ìŠ¤íŠ¸ ë¶„ì„ ë° ì½˜í…ì¸  ìƒì„±
        if 'ì§ˆë¬¸' in context or 'ê¶ê¸ˆ' in context:
            return f"ì•ì„œ í•™ìŠµí•œ ë‚´ìš©ê³¼ ê´€ë ¨í•˜ì—¬ ì¶”ê°€ ì„¤ëª…ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤: {context}"
        elif 'ì˜ˆì‹œ' in context or 'ì‚¬ë¡€' in context:
            return f"êµ¬ì²´ì ì¸ ì˜ˆì‹œë¥¼ í†µí•´ ë” ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤: {context}"
        else:
            return f"ê´€ë ¨ ë‚´ìš©ì— ëŒ€í•œ ë³´ì¶© ì„¤ëª…ì…ë‹ˆë‹¤: {context}"
    
    def _is_concept_relevant(self, concept: str, objective: str) -> bool:
        """ê°œë…ì´ ëª©í‘œì™€ ê´€ë ¨ìˆëŠ”ì§€ í™•ì¸"""
        
        # ê°„ë‹¨í•œ í‚¤ì›Œë“œ ë§¤ì¹­
        return concept.lower() in objective.lower()
    
    def _get_current_timestamp(self) -> str:
        """í˜„ì¬ íƒ€ì„ìŠ¤íƒ¬í”„ ë°˜í™˜"""
        
        from datetime import datetime
        return datetime.now().isoformat()
    
    def validate_content(self, content: Dict[str, Any]) -> bool:
        """ìƒì„±ëœ ì½˜í…ì¸  ìœ íš¨ì„± ê²€ì¦"""
        
        required_fields = ['chapter', 'title', 'introduction', 'main_content', 'examples']
        
        for field in required_fields:
            if field not in content:
                return False
        
        # main_contentê°€ ë¦¬ìŠ¤íŠ¸ì´ê³  ë¹„ì–´ìˆì§€ ì•Šì€ì§€ í™•ì¸
        if not isinstance(content['main_content'], list) or not content['main_content']:
            return False
        
        return True
    
    def _format_content_for_display(self, content: Dict[str, Any]) -> str:
        """ì½˜í…ì¸ ë¥¼ í‘œì‹œìš© í…ìŠ¤íŠ¸ë¡œ í¬ë§·íŒ…"""
        formatted_parts = []
        
        # ì œëª©ê³¼ ë„ì…ë¶€
        formatted_parts.append(f"# {content['title']}\n")
        formatted_parts.append(f"{content['introduction']}\n")
        
        # ë©”ì¸ ì½˜í…ì¸ 
        for section in content['main_content']:
            formatted_parts.append(f"## {section['title']}\n")
            formatted_parts.append(f"{section['content']}\n")
        
        # ì˜ˆì‹œ
        if content['examples']:
            formatted_parts.append("## ğŸ“š ì£¼ìš” ì˜ˆì‹œ\n")
            for i, example in enumerate(content['examples'], 1):
                formatted_parts.append(f"{i}. {example}\n")
        
        # í•µì‹¬ í¬ì¸íŠ¸
        if content['key_points']:
            formatted_parts.append("## ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸\n")
            for point in content['key_points']:
                formatted_parts.append(f"â€¢ {point}\n")
        
        # ë‹¤ìŒ ë‹¨ê³„
        if content['next_steps']:
            formatted_parts.append("## ğŸš€ ë‹¤ìŒ ë‹¨ê³„\n")
            for step in content['next_steps']:
                formatted_parts.append(f"â€¢ {step}\n")
        
        return "\n".join(formatted_parts)
    
    def _calculate_progress(self, state: TutorState) -> int:
        """í•™ìŠµ ì§„í–‰ë¥  ê³„ì‚°"""
        # í˜„ì¬ ì±•í„°ì™€ ë‹¨ê³„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§„í–‰ë¥  ê³„ì‚°
        chapter = state['current_chapter']
        stage = state['current_stage']
        
        # ê°„ë‹¨í•œ ì§„í–‰ë¥  ê³„ì‚° ë¡œì§
        base_progress = (chapter - 1) * 25  # ì±•í„°ë‹¹ 25%
        
        stage_progress = {
            'theory': 5,
            'theory_complete': 10,
            'quiz': 15,
            'feedback': 20,
            'complete': 25
        }
        
        current_stage_progress = stage_progress.get(stage, 0)
        
        return min(100, base_progress + current_stage_progress)